-- V159

local KINGHUB01 = 'https://raw.githubusercontent.com/KINGHUB01/Gui/main/'

local library = loadstring(game:HttpGet('https://raw.githubusercontent.com/mabdu21/YWVATBAUBAK-FISH-IT/refs/heads/main/dfadasdas.lua'))()
local theme_manager = loadstring(game:HttpGet('https://raw.githubusercontent.com/mabdu21/YWVATBAUBAK-FISH-IT/refs/heads/main/jjadjasdhja.lua'))()
local save_manager = loadstring(game:HttpGet(KINGHUB01 .. 'Gui%20Lib%20%5BSaveManager%5D'))()

if not game:IsLoaded() then
    library:Notify("Waiting for game to load...")
    game.Loaded:Wait()
    library:Notify("Loaded Game")
end

local window = library:CreateWindow({
    Title = 'IganhK | SPECTER',
    Center = true,
    AutoShow = true,
    TabPadding = 8,
    MenuFadeTime = 0.2
})

local tabs = {
    main = window:AddTab('Main'),
    esp = window:AddTab('Esp'),
    player = window:AddTab('Player'),
    world = window:AddTab('Lighting'),
    ['ui settings'] = window:AddTab('Settings')
}


local evidence_group = tabs.main:AddRightGroupbox('Evidences')
local ghost_group = tabs.main:AddRightGroupbox('Information')
local game_group = tabs.main:AddLeftGroupbox('Game Settings')
local objquest_group = tabs.main:AddLeftGroupbox('Objectives')

local ghost_esp_group = tabs.esp:AddLeftGroupbox('Ghost Esp Settings')
local player_esp_group = tabs.esp:AddRightGroupbox('Player Esp Settings')
local item_esp_group = tabs.esp:AddLeftGroupbox('Item Esp Settings')
local cursed_esp_group = tabs.esp:AddRightGroupbox('Cursed Esp Settings')
local evidence_esp_group = tabs.esp:AddLeftGroupbox('Evidence Esp Settings')
local closet_esp_group = tabs.esp:AddRightGroupbox('Closet Esp Settings')

local player_group = tabs.player:AddLeftGroupbox('Player Settings')
local misc_group = tabs.player:AddRightGroupbox('Misc')

local world_group = tabs.world:AddRightGroupbox('Visual Settings')
local boost_group = tabs.world:AddLeftGroupbox('Graphic Settings')

local menu_group = tabs['ui settings']:AddLeftGroupbox('Menu')
local credits_group = tabs['ui settings']:AddRightGroupbox('Credits')
local settings_group = tabs['ui settings']:AddRightGroupbox('Menu Settings')

local proximity_prompt_service = game:GetService('ProximityPromptService')
local replicated_storage = game:GetService('ReplicatedStorage')
local user_input_service = game:GetService('UserInputService')
local text_chat_service = game:GetService('TextChatService')
local teleport_service = game:GetService('TeleportService')
--[span_0](start_span)- Label hiển thị kết quả Ghost[span_0](end_span)


-- Bảng map bằng chứng (Dựa trên dữ liệu bạn cung cấp)
local ghostEvidenceMap = {
    Afarit    = {"Motion", "Orbs", "Freezing"},
    Aswang    = {"EMF5", "Fingerprints", "SpiritBox"},
    Banshee   = {"EMF5", "Freezing", "Fingerprints"},
    Bhuta     = {"Motion", "Writing", "Freezing"},
    Blair     = {"EMF5", "Freezing", "SpiritBox"},
    Bogey     = {"Orbs", "Fingerprints", "Motion"},
    Demon     = {"Freezing", "SpiritBox", "Writing"},
    Douen     = {"Motion", "Writing", "Fingerprints"},
    Duppy     = {"SpiritBox", "EMF5", "Orbs"},
    Egui      = {"Orbs", "SpiritBox", "Writing"},
    Haint     = {"Motion", "SpiritBox", "Orbs"},
    Jinn      = {"EMF5", "Motion", "Orbs"},
    Mare      = {"Freezing", "SpiritBox", "Orbs"},
    Mimic     = {"SpiritBox", "Writing", "EMF5"},
    Myling    = {"Motion", "EMF5", "SpiritBox"},
    O_Tokata  = {"EMF5", "Orbs", "Fingerprints"},
    Oni       = {"Motion", "Writing", "SpiritBox"},
    Phantom   = {"Freezing", "EMF5", "Orbs"},
    Poltergeist = {"SpiritBox", "Fingerprints", "Orbs"},
    Preta     = {"Motion", "Fingerprints", "EMF5"},
    Revenant  = {"EMF5", "Writing", "Fingerprints"},
    Shade     = {"EMF5", "Writing", "Orbs"},
    Spirit    = {"Fingerprints", "SpiritBox", "Writing"},
    Thaye     = {"Freezing", "Fingerprints", "Orbs"},
    Upyr      = {"EMF5", "Freezing", "Motion"},
    Wendigo   = {"Motion", "SpiritBox", "Freezing"},
    Wisp      = {"Orbs", "Writing", "Fingerprints"},
    Wraith    = {"Writing", "Motion", "EMF5"},
    Yokai     = {"Fingerprints", "Freezing", "Motion"},
    Yurei     = {"Freezing", "Writing", "Orbs"},
}

local market = game:GetService('MarketplaceService')
local run_service = game:GetService('RunService')
local info = market:GetProductInfo(game.PlaceId)
local workspace = game:GetService('Workspace')
local lighting = game:GetService('Lighting')
local players = game:GetService('Players')
local local_player = players.LocalPlayer
local stats = game:GetService('Stats')
local camera = workspace.CurrentCamera

local evidence_folder = workspace.Dynamic.Evidence
local fingerprints = evidence_folder.Fingerprints
local dropped_equipment = workspace.Equipment
local motions = evidence_folder.MotionGrids
local orbs = evidence_folder.Orbs
local emfs = evidence_folder.EMF
local ghost = workspace.NPCs
local van = workspace.Van
local van_equipment = van.Equipment
local map = workspace.Map
local cursed_objects = map:FindFirstChild('cursed_object')
local bone = map:FindFirstChild('Bone')
local fuse_box = map:FindFirstChild("Fusebox"):FindFirstChild("Fusebox")
local closets = map.Closets
local rooms = map.Rooms

-- Hàm để lấy tất cả vật phẩm bị nguyền rủa + xương + vân tay
local function getAllCursedItems()
    local all_items = {}
    
    -- Thêm các món trong folder cursed_object
    if cursed_objects then
        for _, v in pairs(cursed_objects:GetChildren()) do
            table.insert(all_items, v)
        end
    end
    
    -- Thêm Bone (nếu tồn tại)
    if bone then
        table.insert(all_items, bone)
    end
    
    -- Thêm tất cả Fingerprints trong folder
    if fingerprints then
        for _, v in pairs(fingerprints:GetChildren()) do
            table.insert(all_items, v)
        end
    end
    
    return all_items
end






local GhostInfo = workspace.Van.Objectives.SurfaceGui.Frame.Objectives.GhostInfo

local cursed_object_highlight = false

local found_writing = false

local ghost_room_pos = nil -- Dùng để TP
local ghost_room_found = false


local cursed_object_name = false
local found_fingerprint = false
local player_highlight = false
local closet_highlight = false
local highlight_ghost = false
local got_spirit_box = false
local item_highlight = false
local speed_sprint = false
local third_person = false
local jump_enabled = false
local closet_name = false
local player_name = false
local full_bright = false
local inf_stamina = false
local anti_touch = false
local show_ghost = false
local got_motion = false
local got_freezing = false -- Thêm dòng này vào khoảng dòng 140


local ghost_name = false

local no_motion = false
local item_name = false
local found_emf = false
local found_orb = false
local orbs_name = false
local emf_name = false
local inf_jump = false
local no_hold = false
local nofog = false
local fps = false

local freezing_label = evidence_group:AddLabel('Freezing Temp: Not Found')
local ghostwriting_label = evidence_group:AddLabel('Ghost Writing: Not Found')
local fingerprint_label = evidence_group:AddLabel('Fingerprints: Not Found')
local motion_label = evidence_group:AddLabel('Para Motion: Not Found')
local spirit_box_label = evidence_group:AddLabel('Spirit Box: Not Found')
local orb_label = evidence_group:AddLabel('Orbs: Not Found')


evidence_group:AddDivider()

local emf_label = evidence_group:AddLabel('EMF 5: Not Found')

local last_emf_label = evidence_group:AddLabel('Last EMF: Not Found')
evidence_group:AddDivider()
local ghost_label = evidence_group:AddLabel('ghost: not found')

local function updateGhostType()
    -- Thêm dòng kiểm tra này
    if not ghost_label then return end 
    
    local currentEvidences = {}
    -- ... (giữ nguyên phần code bên trong)

    if found_emf then table.insert(currentEvidences, "EMF5") end
    if found_fingerprint then table.insert(currentEvidences, "Fingerprints") end
    if found_orb then table.insert(currentEvidences, "Orbs") end
    if found_writing then table.insert(currentEvidences, "Writing") end
    if got_motion then table.insert(currentEvidences, "Motion") end
    if got_spirit_box then table.insert(currentEvidences, "SpiritBox") end
    if got_freezing then table.insert(currentEvidences, "Freezing") end

    -- Duyệt qua Map để tìm Ghost khớp 3 bằng chứng
    for name, evidences in pairs(ghostEvidenceMap) do
        local matchCount = 0
        for _, ev in ipairs(evidences) do
            for _, foundEv in ipairs(currentEvidences) do
                if ev == foundEv then
                    matchCount = matchCount + 1
                end
            end
        end

        if matchCount >= 3 then
            ghost_label:SetText('ghost: ' .. name)
            return
        end
    end
    ghost_label:SetText('ghost: not found')
end


local found_name = "N/A"

local touch_distance = 7
local sprint_speed = 1

local ghost_room = nil

if game:IsLoaded() then
    local device = local_player:GetAttribute('Device')
    local gid = local_player:GetAttribute("GID")
    local join_time = local_player:GetAttribute('JoinTime')

    if device or gid or join_time then
        print("====================================================")
        print("Device: " .. device)
        print("LocalPlayer GID: " .. gid)
        print("Join Time: " .. os.date("%Y-%m-%d %H:%M:%S", join_time))
        print("====================================================")
    end
else
    local_player:Kick('Game failed to load, please rejoin and retry... (If it keeps happening please contact @DYHUB on discord!)')
end



ghost_group:AddDivider()

local ghost_name_label = ghost_group:AddLabel('Ghost Name: N/A')
local ghost_room_label = ghost_group:AddLabel('Ghost Room: Not Found')
local ghost_speed_label = ghost_group:AddLabel('Ghost Speed: Not Found')

ghost_group:AddDivider()

local sanity_label = ghost_group:AddLabel('Player Sanity:')

emfs.ChildAdded:Connect(function(emf)
    if emf:IsA("Part") and emf.Name == 'EMF5' and not found_emf then
        emf_label:SetText('EMF 5: Yes')
        library:Notify("Found EMF 5")
        found_emf = true
        updateGhostType()
    end

    if emf:IsA("Part") then
        last_emf_label:SetText('Last EMF: ' .. emf.Name)
        library:Notify("Last EMF: " .. emf.Name)
    end
end)

fingerprints.ChildAdded:Connect(function(fingerprint)
    if fingerprint:IsA("Part") and not found_fingerprint then
        fingerprint_label:SetText('Fingerprints: Yes')
        library:Notify("Found Fingerprint")
        found_fingerprint = true
        updateGhostType()
    end
end)

orbs.ChildAdded:Connect(function(orb)
    if orb:IsA("Part") and not found_orb then
        orb_label:SetText('Orbs: Yes')
        library:Notify("Found Orbs")
        found_orb = true
        updateGhostType()
    end
end)


local function checkGhostWriting(item)
    if item.Name == "Book" then
        local rightPage = item:FindFirstChild("RightPage")
        if rightPage then
            -- 1. Kiểm tra xem ĐÃ CÓ Decal nào chưa (Trường hợp ma viết xong trước khi script chạy)
            local existingDecal = rightPage:FindFirstChildOfClass("Decal")
            if existingDecal and not found_writing then
                found_writing = true
                ghostwriting_label:SetText('Ghost Writing: Yes')
                library:Notify("Found Ghost Writing (Existing)")
                updateGhostType()
                return
            end

            -- 2. Kết nối sự kiện để chờ ma viết (Trường hợp ma sắp viết)
            -- Sử dụng thuộc tính để tránh kết nối trùng lặp nhiều lần
            if not item:GetAttribute("Connected") then
                item:SetAttribute("Connected", true)
                rightPage.ChildAdded:Connect(function(child)
                    if child:IsA("Decal") and not found_writing then
                        found_writing = true
                        ghostwriting_label:SetText('Ghost Writing: Yes')
                        library:Notify("Found Ghost Writing (New)")
                        updateGhostType()
                    end
                end)
            end
        end
    end
end

-- Tích hợp vào vòng lặp quét Equipment của bạn
task.spawn(function()
    while true do
        task.wait(1)
        local equipment = workspace:FindFirstChild("Equipment")
        if equipment then
            for _, item in pairs(equipment:GetChildren()) do
                -- Gọi hàm check cho mỗi cuốn sách tìm thấy
                checkGhostWriting(item)
            end
        end
        
        -- Nếu đã tìm thấy writing thì có thể dừng vòng lặp này hoặc cứ để nó chạy cho các bằng chứng khác
        if found_writing then 
            -- break -- Bỏ comment nếu muốn dừng quét sau khi tìm thấy
        end
    end
end)

-- [[ LOGIC TÌM GHOST ROOM CHUẨN V4 ]] --
task.spawn(function()
    local RoomScanService = game:GetService("RunService")
    
    -- Biến lưu tạm vị trí con ma khi mới vào game
    local found_ghost_pos = nil 

    -- Vòng lặp 1: Tìm vị trí đứng của con ma (Lấy từ workspace.NPCs)
    local GhostFinderConnection
    GhostFinderConnection = RoomScanService.RenderStepped:Connect(function()
        if ghost_room_found then 
            GhostFinderConnection:Disconnect()
            return 
        end

        local npcs = workspace:FindFirstChild("NPCs")
        if npcs then
            for _, model in pairs(npcs:GetChildren()) do
                if model:IsA("Model") then
                    -- V4 tìm MeshPart tên là "Base" trong con ma
                    local base = model:FindFirstChild("Base") 
                    if base and base:IsA("MeshPart") then
                        found_ghost_pos = base.Position -- Lưu tọa độ ma
                        ghost_room_pos = base.CFrame    -- Lưu CFrame để TP
                        GhostFinderConnection:Disconnect() -- Dừng quét ma, chuyển sang quét phòng
                        break
                    end
                end
            end
        end
    end)

    -- Vòng lặp 2: So sánh vị trí ma với Hitbox của các phòng để lấy tên
    while task.wait(1) do
        if ghost_room_found then break end

        -- Chỉ chạy khi đã bắt được tọa độ con ma ở bước trên
        if found_ghost_pos then
            local map = workspace:FindFirstChild("Map")
            local rooms = map and map:FindFirstChild("Rooms")
            
            if rooms then
                -- Quét tất cả Hitbox trong folder Rooms
                for _, obj in pairs(rooms:GetDescendants()) do
                    if obj.Name == "Hitbox" and obj:IsA("BasePart") then
                        -- Kiểm tra khoảng cách: Nếu ma đứng cách Hitbox phòng dưới 15 mét -> Đó là phòng ma
                        local distance = (found_ghost_pos - obj.Position).Magnitude
                        
                        if distance < 15 then -- V4 dùng range 15
                            ghost_room_found = true
                            local realRoomName = obj.Parent.Name
                            
                            -- Cập nhật UI Linoria
                            if ghost_room_label then
                                ghost_room_label:SetText("Ghost Room: " .. realRoomName)
                            end
                            
                            library:Notify("Ghost Room Found: " .. realRoomName)
                            
                            -- Thông báo hệ thống
                            game:GetService("StarterGui"):SetCore("SendNotification", {
                                Title = "Specter 2 Finder",
                                Text = "Room: " .. realRoomName,
                                Duration = 5
                            })
                            break
                        end
                    end
                end
            end
        end
    end
end)




motionconnection = run_service.RenderStepped:Connect(function()
    for _, motion in pairs(motions:GetDescendants()) do
        if motion:IsA("Part") then
            if motion.Color == Color3.fromRGB(252, 52, 52) then
                motion_label:SetText('Motion: Yes')
                library:Notify("Found Motion")
                got_motion = true
                updateGhostType()
                motionconnection:Disconnect()
                break
            elseif motion.BrickColor == BrickColor.new("Toothpaste") then
                motion_label:SetText('Motion: No')
                library:Notify("No Motion Found")
                no_motion = true
                motionconnection:Disconnect()
                break
            end
        end
    end
end)

local function getGhostName(text)
    local name = string.match(text, "<font.-%>(.-)</font>")
    return name or "N/A"
end

found_name = getGhostName(GhostInfo.Text)
ghost_name_label:SetText("Ghost Name: " .. found_name)

GhostInfo:GetPropertyChangedSignal("Text"):Connect(function()
    found_name = getGhostName(GhostInfo.Text)
    ghost_name_label:SetText("Ghost Name: " .. found_name)
end)

local run_service = game:GetService("RunService")
local local_player = game:GetService("Players").LocalPlayer

-- สร้างการเชื่อมต่อ
local sanityconnection
sanityconnection = run_service.RenderStepped:Connect(function()
    -- หา Player Sanity ของผู้เล่นปัจจุบัน
    local player_frame = workspace.Van.SanityBoard.SurfaceGui.Frame.Players:FindFirstChild(local_player.DisplayName)
    if player_frame then
        local sanity_val = player_frame.Entire.Val
        if sanity_val then
            sanity_label:SetText('Player Sanity: ' .. sanity_val.Text)
        end
    end

    -- ตรวจสอบว่าผู้เล่นตายหรือยัง
    local character = local_player.Character
    if character and character:FindFirstChild("Humanoid") then
        if character.Humanoid.Health <= 0 then
            sanity_label:SetText('Player Sanity: Dead')
            sanityconnection:Disconnect()
        end
    end
end)

ghostconnection = run_service.RenderStepped:Connect(function()
    if anti_touch then
        for _, v in pairs(ghost:GetChildren()) do
            if v:IsA("Model") then
                local Distance = (local_player.Character.HumanoidRootPart.Position - v.PrimaryPart.Position).Magnitude
                if Distance < touch_distance then
                    local_player.Character.HumanoidRootPart.CFrame = van.PrimaryPart.CFrame + Vector3.new(0, 5, 0)
                    Library:Notify("Ghost was too close teleported to save place.")
                end
            end
        end

        for _, v in pairs(ghost:GetChildren()) do
            if v:IsA("Model") then
                local humanoid = v:FindFirstChild("Humanoid")
                ghost_speed_label:SetText('Ghost Speed: ' .. string.format("%.1f", humanoid.WalkSpeed))
            end
        end
    end
end)

playerconnection = run_service.RenderStepped:Connect(function()
    if inf_stamina then
        local_player:SetAttribute('Stamina', 100)
    end

    if speed_sprint then
        local_player:SetAttribute('Speed', sprint_speed)
    end

    if noclip then
        local_player.Character.HumanoidRootPart.CanCollide = false
        local_player.Character.UpperTorso.CanCollide = false
        local_player.Character.LowerTorso.CanCollide = false
        local_player.Character.Head.CanCollide = false
    end
end)

espconnection = run_service.RenderStepped:Connect(function()
    if not local_player.Character then
        local_player.CharacterAdded:Wait()
    end

    if show_ghost then
        for _, silly_ghost in pairs(ghost:GetChildren()) do
            if silly_ghost:IsA("Model") then
                silly_ghost:FindFirstChildOfClass("MeshPart").Transparency = 0
            end
        end

        if highlight_ghost then
            for _, silly_ghost in pairs(ghost:GetChildren()) do
                if silly_ghost:IsA("Model") and not silly_ghost:FindFirstChild("Highlight") then
                    local Highlight = Instance.new("Highlight")
                    Highlight.Parent = silly_ghost
                    Highlight.FillTransparency = 1        -- Làm trong suốt phần ruột
    Highlight.OutlineTransparency = 0     -- Hiện viền đậm
                    Highlight.FillColor = highlight_color_ghost
                    Highlight.OutlineColor = highlight_color_ghost
                end
            end
        end

        if ghost_name then
            for _, silly_ghost in pairs(ghost:GetChildren()) do
                if silly_ghost:IsA("Model") and not silly_ghost:FindFirstChild("Esp BillBoard") then
                    local esp_billboard = Instance.new("BillboardGui")
                    esp_billboard.Parent = silly_ghost
                    esp_billboard.Name = "Esp BillBoard"
                    esp_billboard.Adornee = silly_ghost.PrimaryPart
                    esp_billboard.Size = UDim2.new(0, 100, 0, 50)
                    esp_billboard.StudsOffset = Vector3.new(0, 5, 0)
                    esp_billboard.AlwaysOnTop = true

                    local esp_text = Instance.new("TextLabel")
                    esp_text.Parent = esp_billboard
                    esp_text.Name = "Name Esp"
                    esp_text.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                    esp_text.Size = UDim2.new(1, 0, 1, 0)
                    esp_text.Text = "Ghost [" .. silly_ghost.Name .. "]"
                    esp_text.TextColor3 = highlight_color_ghost
                    esp_text.TextSize = 14
                    esp_text.Font = "SourceSansBold"
                    esp_text.BackgroundTransparency = 1
                    esp_text.TextStrokeTransparency = 0
                    esp_text.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
                end
            end
        end
    end

    if player_name then
        for _, player in pairs(players:GetPlayers()) do
            if player ~= local_player and player.Character and player.Character:FindFirstChild("Head") and player.Character:FindFirstChild("Humanoid") then
                local humanoid = player.Character:FindFirstChild("Humanoid")
                if humanoid.Health > 0 and not player.Character.Head:FindFirstChild("Esp BillBoard") then
                    local esp_billboard = Instance.new("BillboardGui")
                    esp_billboard.Parent = player.Character.Head
                    esp_billboard.Name = "Esp BillBoard"
                    esp_billboard.Adornee = player.Character.Head
                    esp_billboard.Size = UDim2.new(0, 100, 0, 50)
                    esp_billboard.StudsOffset = Vector3.new(0, 2, 0)
                    esp_billboard.AlwaysOnTop = true

                    local esp_text = Instance.new("TextLabel")
                    esp_text.Parent = esp_billboard
                    esp_text.Name = "Name Esp"
                    esp_text.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                    esp_text.Size = UDim2.new(1, 0, 1, 0)
                    esp_text.Text = player.DisplayName
                    esp_text.TextColor3 = player_highlight_color
                    esp_text.TextSize = 14
                    esp_text.Font = "SourceSansBold"
                    esp_text.BackgroundTransparency = 1
                    esp_text.TextStrokeTransparency = 0
                    esp_text.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
                end
            end
        end
    end

    if player_highlight then
        for _, player in pairs(players:GetPlayers()) do
            if player ~= local_player and player.Character and player.Character:FindFirstChild("Humanoid") then
                local humanoid = player.Character:FindFirstChild("Humanoid")
                if humanoid.Health > 0 and not player.Character:FindFirstChild("Highlight") then
                    local Highlight = Instance.new("Highlight")
                    Highlight.Parent = player.Character
                    Highlight.FillTransparency = 1        -- Làm trong suốt phần ruột
    Highlight.OutlineTransparency = 0     -- Hiện viền đậm
                    Highlight.FillColor = player_highlight_color
                    Highlight.OutlineColor = player_highlight_color
                end
            end
        end
    end

    if item_name then
        for _, v in next, van_equipment:GetChildren() do
            if v:IsA("Model") and not v:FindFirstChild("Esp BillBoard") then
                local esp_billboard = Instance.new("BillboardGui")
                esp_billboard.Parent = v
                esp_billboard.Name = "Esp BillBoard"
                esp_billboard.Adornee = v.PrimaryPart
                esp_billboard.Size = UDim2.new(0, 100, 0, 50)
                esp_billboard.StudsOffset = Vector3.new(0, 1, 0)
                esp_billboard.AlwaysOnTop = true

                local esp_text = Instance.new("TextLabel")
                esp_text.Parent = esp_billboard
                esp_text.Name = "Name Esp"
                esp_text.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                esp_text.Size = UDim2.new(1, 0, 1, 0)
                esp_text.Text = v.Name
                esp_text.TextColor3 = item_highlight_color
                esp_text.TextSize = 14
                esp_text.Font = "SourceSansBold"
                esp_text.BackgroundTransparency = 1
                esp_text.TextStrokeTransparency = 0
                esp_text.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
            end
        end
    end

    if item_name then
        for _, v in next, dropped_equipment:GetChildren() do
            if v:IsA("Model") and not v:FindFirstChild("Esp BillBoard") then
                local esp_billboard = Instance.new("BillboardGui")
                esp_billboard.Parent = v
                esp_billboard.Name = "Esp BillBoard"
                esp_billboard.Adornee = v.PrimaryPart
                esp_billboard.Size = UDim2.new(0, 100, 0, 50)
                esp_billboard.StudsOffset = Vector3.new(0, 1, 0)
                esp_billboard.AlwaysOnTop = true

                local esp_text = Instance.new("TextLabel")
                esp_text.Parent = esp_billboard
                esp_text.Name = "Name Esp"
                esp_text.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                esp_text.Size = UDim2.new(1, 0, 1, 0)
                esp_text.Text = v.Name
                esp_text.TextColor3 = item_highlight_color
                esp_text.TextSize = 14
                esp_text.Font = "SourceSansBold"
                esp_text.BackgroundTransparency = 1
                esp_text.TextStrokeTransparency = 0
                esp_text.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
            end
        end
    end

    if item_highlight then
        for _, v in next, dropped_equipment:GetChildren() do
            if v:IsA("Model") and not v:FindFirstChild("Highlight") then
                local Highlight = Instance.new("Highlight")
                Highlight.Parent = v
                Highlight.FillTransparency = 1        -- Làm trong suốt phần ruột
    Highlight.OutlineTransparency = 0     -- Hiện viền đậm
                Highlight.FillColor = item_highlight_color
                Highlight.OutlineColor = item_highlight_color
            end
        end
    end

    if item_highlight then
        for _, v in next, van_equipment:GetChildren() do
            if v:IsA("Model") and not v:FindFirstChild("Highlight") then
                local Highlight = Instance.new("Highlight")
                Highlight.Parent = v
                Highlight.FillTransparency = 1        -- Làm trong suốt phần ruột
    Highlight.OutlineTransparency = 0     -- Hiện viền đậm
                Highlight.FillColor = item_highlight_color
                Highlight.OutlineColor = item_highlight_color
            end
        end
    end
    
    if cursed_object_name then
for _, v in next, getAllCursedItems() do 
        if (v:IsA("MeshPart") or v:IsA("Model") or v:IsA("Part")) and not (v.Name == "Chair" or v.Name == "Body" or v.Name == "Eye1" or v.Name == "Eye2") and not v:FindFirstChild("Esp BillBoard") then
                local esp_billboard = Instance.new("BillboardGui")
                esp_billboard.Parent = v
                esp_billboard.Name = "Esp BillBoard"
                esp_billboard.Adornee = v
                esp_billboard.Size = UDim2.new(0, 100, 0, 50)
                esp_billboard.StudsOffset = Vector3.new(0, 1, 0)
                esp_billboard.AlwaysOnTop = true

                local esp_text = Instance.new("TextLabel")
                esp_text.Parent = esp_billboard
                esp_text.Name = "Name Esp"
                esp_text.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                esp_text.Size = UDim2.new(1, 0, 1, 0)
                esp_text.Text = v.Name
                esp_text.TextColor3 = cursed_object_highlight_color
                esp_text.TextSize = 14
                esp_text.Font = "SourceSansBold"
                esp_text.BackgroundTransparency = 1
                esp_text.TextStrokeTransparency = 0
                esp_text.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
            end
        end
    end

    if cursed_object_highlight then
        for _, v in next, getAllCursedItems() do
        if (v:IsA("MeshPart") or v:IsA("Model") or v:IsA("Part")) and not (v.Name == "Chair" or v.Name == "Body") and not v:FindFirstChild("Highlight") then
                local Highlight = Instance.new("Highlight")
                Highlight.Parent = v
                Highlight.FillTransparency = 1        -- Làm trong suốt phần ruột
    Highlight.OutlineTransparency = 0     -- Hiện viền đậm
                Highlight.FillColor = cursed_object_highlight_color
                Highlight.OutlineColor = cursed_object_highlight_color
            end
        end
    end

    if emf_name then
        for _, v in next, emfs:GetChildren() do
            if v:IsA("Part") and not v:FindFirstChild("Esp BillBoard") then
                local esp_billboard = Instance.new("BillboardGui")
                esp_billboard.Parent = v
                esp_billboard.Name = "Esp BillBoard"
                esp_billboard.Adornee = v
                esp_billboard.Size = UDim2.new(0, 100, 0, 50)
                esp_billboard.StudsOffset = Vector3.new(0, 1, 0)
                esp_billboard.AlwaysOnTop = true

                local esp_text = Instance.new("TextLabel")
                esp_text.Parent = esp_billboard
                esp_text.Name = "Name Esp"
                esp_text.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                esp_text.Size = UDim2.new(1, 0, 1, 0)
                esp_text.Text = v.Name
                esp_text.TextColor3 = Color3.fromRGB(255, 255, 255)
                esp_text.TextSize = 14
                esp_text.Font = "SourceSansBold"
                esp_text.BackgroundTransparency = 1
                esp_text.TextStrokeTransparency = 0
                esp_text.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
            end
        end
    end

    if orbs_name then
        for _, v in next, orbs:GetChildren() do
            if v:IsA("Part") and not v:FindFirstChild("Esp BillBoard") then
                local esp_billboard = Instance.new("BillboardGui")
                esp_billboard.Parent = v
                esp_billboard.Name = "Esp BillBoard"
                esp_billboard.Adornee = v
                esp_billboard.Size = UDim2.new(0, 100, 0, 50)
                esp_billboard.StudsOffset = Vector3.new(0, 1, 0)
                esp_billboard.AlwaysOnTop = true

                local esp_text = Instance.new("TextLabel")
                esp_text.Parent = esp_billboard
                esp_text.Name = "Name Esp"
                esp_text.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                esp_text.Size = UDim2.new(1, 0, 1, 0)
                esp_text.Text = v.Name
                esp_text.TextColor3 = Color3.fromRGB(255, 255, 255)
                esp_text.TextSize = 14
                esp_text.Font = "SourceSansBold"
                esp_text.BackgroundTransparency = 1
                esp_text.TextStrokeTransparency = 0
                esp_text.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
            end
        end
    end

    if closet_name then
        for _, v in next, closets:GetChildren() do
            if v:IsA("Model") and not v:FindFirstChild("Esp BillBoard") then
                local esp_billboard = Instance.new("BillboardGui")
                esp_billboard.Parent = v
                esp_billboard.Name = "Esp BillBoard"
                esp_billboard.Adornee = v
                esp_billboard.Size = UDim2.new(0, 100, 0, 50)
                esp_billboard.StudsOffset = Vector3.new(0, 5, 0)
                esp_billboard.AlwaysOnTop = true

                local esp_text = Instance.new("TextLabel")
                esp_text.Parent = esp_billboard
                esp_text.Name = "Name Esp"
                esp_text.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                esp_text.Size = UDim2.new(1, 0, 1, 0)
                esp_text.Text = "Hiding Spot"
                esp_text.TextColor3 = closet_highlight_color
                esp_text.TextSize = 14
                esp_text.Font = "SourceSansBold"
                esp_text.BackgroundTransparency = 1
                esp_text.TextStrokeTransparency = 0
                esp_text.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
            end
        end
    end

    if closet_highlight then
        for _, v in next, closets:GetChildren() do
            if v:IsA("Model") and not v:FindFirstChild("Highlight") then
                local highlight = Instance.new("Highlight")
                highlight.Parent = v
                highlight.FillTransparency = 1        -- Làm trong suốt phần ruột
    highlight.OutlineTransparency = 0     -- Hiện viền đậm
                highlight.FillColor = closet_highlight_color
                highlight.OutlineColor = closet_highlight_color
            end
        end
    end
end)

proximity_prompt_service.PromptButtonHoldBegan:Connect(function(prompt)
    if no_hold then
        prompt.HoldDuration = 0
    end
end)

user_input_service.JumpRequest:Connect(function()
    if inf_jump then
        local_player.Character.Humanoid:ChangeState("Jumping")
    end
end)

game_group:AddDivider()

game_group:AddButton({
    Text = 'Collect Bone',

    Func = function()
        if bone then
            bone_prompt = bone:FindFirstChildOfClass("ProximityPrompt")
            last_pos = local_player.Character.HumanoidRootPart.CFrame

            if bone_prompt then
                local_player.Character.HumanoidRootPart.CFrame = bone.CFrame + Vector3.new(0, 5, 0)
                task.wait(.25)
                fireproximityprompt(bone_prompt)
                task.wait(.25)
                local_player.Character.HumanoidRootPart.CFrame = last_pos
                library:Notify("Collected Bone")
            end
        else
            library:Notify("Bone not found")
        end
    end,
    DoubleClick = false,
    Tooltip = 'Collects the bone'
})

game_group:AddButton({
    Text = 'Report Dirty Water',

    Func = function()
        local active_water = nil
        local active_prompt = nil
        local active_beam = nil
        
        -- 1. QUÉT TÌM CÁI NƯỚC ĐANG "ACTIVE" NHẤT
        local all_waters = {}
        for _, v in pairs(workspace:GetDescendants()) do
            if v.Name == "Water" and v:IsA("BasePart") then
                local p = v:FindFirstChildOfClass("ProximityPrompt")
                if p and (p.ObjectText == "Report dirty water" or p.ActionText == "Report dirty water") then
                    table.insert(all_waters, {part = v, prompt = p})
                end
            end
        end

        -- Ưu tiên chọn cái vòi nào đang xả (Beam == true)
        for _, obj in pairs(all_waters) do
            local f = obj.part:FindFirstChild("Faucet", true) or obj.part.Parent:FindFirstChild("Faucet", true)
            local b = f and f:FindFirstChildWhichIsA("Beam", true)
            
            if (b and b.Enabled == true) or obj.prompt.Enabled == true then
                active_water = obj.part
                active_prompt = obj.prompt
                active_beam = b
                break -- Đã tìm thấy vòi đang hoạt động
            end
        end

        -- 2. XỬ LÝ NẾU TÌM THẤY
        if active_water and active_prompt then
            library:Notify("Found active dirty water! Checking status...")

            -- Nếu Beam đang bật, bắt buộc đợi cho đến khi nó tắt hoặc tối đa 10s
            if active_beam and active_beam.Enabled == true then
                library:Notify("Water is pumping... Waiting for it to finish.")
                local wait_limit = 0
                while active_beam.Enabled == true and wait_limit < 20 do
                    task.wait(0.5)
                    wait_limit = wait_limit + 1
                end
                task.wait(1) -- Đợi thêm 1s cho nước ổn định sau khi tắt vòi
            end

            -- 3. VÒNG LẶP ĐỢI PROMPT HOẶC DỪNG DI CHUYỂN
            local is_ready = false
            local last_pos = active_water.Position
            
            for i = 1, 30 do -- Đợi tối đa 15 giây
                task.wait(0.5)
                
                -- Nếu Prompt bật (Dấu hiệu quan trọng nhất)
                if active_prompt.Enabled == true then
                    is_ready = true
                    break
                end
                
                -- Check nếu nước đã dừng trồi lên/đổi size
                local current_pos = active_water.Position
                if (current_pos - last_pos).Magnitude < 0.001 and i > 4 then
                    -- Nếu đứng yên và không còn Beam nữa
                    if not active_beam or active_beam.Enabled == false then
                        is_ready = true
                        break
                    end
                end
                last_pos = current_pos
            end

            -- 4. THỰC HIỆN TELEPORT
            if is_ready or active_prompt.Enabled then
                local last_cframe = local_player.Character.HumanoidRootPart.CFrame
                
                -- Nhảy tới
                local_player.Character.HumanoidRootPart.CFrame = active_water.CFrame + Vector3.new(0, 3, 0)
                task.wait(0.6) -- Đợi lâu hơn chút để tránh lỗi vị trí
                
                if active_prompt.Enabled then
                    fireproximityprompt(active_prompt)
                    library:Notify("Reported Dirty Water successfully!")
                else
                    library:Notify("Dirty water is being pumped out, and a report cannot be made yet.")
                end
                
                task.wait(0.3)
                local_player.Character.HumanoidRootPart.CFrame = last_cframe
            else
                library:Notify("Dirty water is stuck or has not yet appeared.")
            end
        else
            library:Notify("Dirty Water not found")
        end
    end,
    DoubleClick = false,
    Tooltip = 'Tp to the location with dirty water and report it.'
})

local auto_report_water = false -- Biến kiểm soát trạng thái toggle

game_group:AddToggle('AutoReportWater', {
    Text = 'Auto Report Dirty Water',
    Default = false,
    Tooltip = 'Automatically teleports and reports dirty water when detected',

    Callback = function(Value)
        auto_report_water = Value
        
        if auto_report_water then
            task.spawn(function()
                while auto_report_water do
                    task.wait(60) -- Quét mỗi 1p một lần để tránh lag
                    
                    local active_water = nil
                    local active_prompt = nil
                    local active_beam = nil
                    
                    -- 1. TÌM NƯỚC BẨN ĐANG HOẠT ĐỘNG
                    for _, v in pairs(workspace:GetDescendants()) do
                        if v.Name == "Water" and v:IsA("BasePart") then
                            local p = v:FindFirstChildOfClass("ProximityPrompt")
                            if p and (p.ObjectText == "Report dirty water" or p.ActionText == "Report dirty water") then
                                -- Kiểm tra nếu vòi đang xả nước (Beam)
                                local f = v:FindFirstChild("Faucet", true) or v.Parent:FindFirstChild("Faucet", true)
                                local b = f and f:FindFirstChildWhichIsA("Beam", true)
                                
                                -- Nếu Prompt đã bật HOẶC Beam đang chạy thì đây là mục tiêu
                                if p.Enabled or (b and b.Enabled) then
                                    active_water = v
                                    active_prompt = p
                                    active_beam = b
                                    break 
                                end
                            end
                        end
                    end

                    -- 2. LOGIC XỬ LÝ TỰ ĐỘNG
                    if active_water and active_prompt then
                        -- Nếu Beam đang bật, đợi cho đến khi tắt (tối đa 15s)
                        local timeout = 0
                        while active_beam and active_beam.Enabled and timeout < 30 do
                            task.wait(0.5)
                            timeout = timeout + 1
                        end

                        -- Đợi thêm 1s cho nước ổn định vị trí/kích thước
                        task.wait(1)

                        -- Kiểm tra lại Prompt trước khi bay tới
                        if active_prompt.Enabled and auto_report_water then
                            local last_cframe = local_player.Character.HumanoidRootPart.CFrame
                            
                            -- Teleport & Fire
                            local_player.Character.HumanoidRootPart.CFrame = active_water.CFrame + Vector3.new(0, 3, 0)
                            task.wait(0.5)
                            
                            if active_prompt.Enabled then
                                fireproximityprompt(active_prompt)
                                library:Notify("Auto Reported Dirty Water!")
                                -- Đợi một chút để game cập nhật, tránh loop teleport liên tục vào 1 chỗ
                                task.wait(0.5)
                            end
                            
                            local_player.Character.HumanoidRootPart.CFrame = last_cframe
                            
                            -- Sau khi report xong 1 cái, nghỉ 5s để tránh lỗi hoặc đợi ma làm bẩn bồn khác
                            task.wait(5)
                        end
                    end
                end
            end)
        end
    end
})






game_group:AddButton({
    Text = 'Enable Power',

    Func = function()
        for _, v in next, fuse_box:GetChildren() do
            if v:IsA("ProximityPrompt") and v.name == "FuseboxPrompt" then
                local last_pos = local_player.Character.HumanoidRootPart.CFrame
                local_player.Character.HumanoidRootPart.CFrame = v.Parent.CFrame
                task.wait(.2)
                fireproximityprompt(v)
                task.wait(.2)
                local_player.Character.HumanoidRootPart.CFrame = last_pos
                local fuse_box_toggles = Workspace.Map.Fusebox
                if fuse_box_toggles then
                    if fuse_box_toggles:FindFirstChild("On").Transparency == 0 then
                        library:Notify("Turned off power box.")
                    else
                        if fuse_box_toggles:FindFirstChild("Off").Transparency == 0 then
                            library:Notify("Turned on power box.")
                        end
                    end
                end
            end
        end
    end,
    DoubleClick = false,
    Tooltip = 'Turns on/off the power box'
})

game_group:AddDivider()

local auto_scan_enabled = true
local ghost_room_found = false
local emf_active_timers = {}

-- Hàm kiểm tra màu đỏ đặc trưng của ma (170, 0, 0)
local function isGhostColor(color)
    local target = Color3.fromRGB(170, 0, 0)
    return math.abs(color.R - target.R) + math.abs(color.G - target.G) + math.abs(color.B - target.B) < 0.02
end

-- 1. LOGIC QUÉT KHUNG CHAT (Giữ nguyên)
game:GetService("TextChatService").OnIncomingMessage = function(message)
    if not auto_scan_enabled or got_spirit_box then return end
    if message.Status == Enum.TextChatMessageStatus.Success then
        local rawText = message.Text
        if rawText:find("170") or rawText:find("rgb") or rawText:find("#aa0000") then
            got_spirit_box = true
            spirit_box_label:SetText("Spirit Box: Yes")
            library:Notify("Evidence Found: Spirit Box (Chat)")
            updateGhostType()
        end
    end
end

-- 2. HÀM QUÉT BILLBOARD SPIRIT BOX
local function checkSpiritBoxBillboard(desc)
    if desc:IsA("BillboardGui") and desc.Enabled then
        local textLabel = desc:FindFirstChildWhichIsA("TextLabel", true)
        if textLabel and textLabel.TextTransparency < 1 then
            if isGhostColor(textLabel.TextColor3) and textLabel.Text ~= "" and textLabel.Text ~= "..." then
                if not got_spirit_box then
                    got_spirit_box = true
                    spirit_box_label:SetText("Spirit Box: Yes")
                    library:Notify("Evidence Found: Spirit Box (Billboard)")
                    updateGhostType()
                end
            end
        end
    end
end

-- 3. VÒNG LẶP QUÉT TỔNG HỢP
task.spawn(function()
    while true do
        task.wait(0.5) 
        if not auto_scan_enabled then continue end

        -- Gom tất cả item từ Workspace và Character vào một bảng để quét
        local items_to_scan = {}
        
        -- Quét dưới đất
        local ground_eq = workspace:FindFirstChild("Equipment")
        if ground_eq then
            for _, v in pairs(ground_eq:GetChildren()) do table.insert(items_to_scan, v) end
        end
        
        -- Quét trên tay (Trong nhân vật)
        if local_player.Character then
            for _, v in pairs(local_player.Character:GetChildren()) do
                -- Nếu là Model thiết bị trực tiếp hoặc nằm trong folder EquipmentModel
                if v:IsA("Model") then
                    table.insert(items_to_scan, v)
                elseif v.Name == "EquipmentModel" then
                    for _, sub_v in pairs(v:GetChildren()) do table.insert(items_to_scan, sub_v) end
                end
            end
        end

        for _, item in pairs(items_to_scan) do
            -- A. LOGIC SPIRIT BOX (Cập nhật check đệ quy cho đồ trên tay)
            if item.Name == "Spirit Box" then
                for _, desc in pairs(item:GetDescendants()) do
                    checkSpiritBoxBillboard(desc)
                end
                
                if not item:GetAttribute("SB_Connected") then
                    item:SetAttribute("SB_Connected", true)
                    item.DescendantAdded:Connect(function(newDesc)
                        task.wait(0.1)
                        checkSpiritBoxBillboard(newDesc)
                    end)
                end
            end

            -- B. LOGIC EMF 2 & 5 (SỬA LỖI TRÊN TAY)
            if item.Name == "EMF Reader" then
                local activeColor = Color3.fromRGB(131, 156, 49)
                
                -- Sử dụng tham số 'true' để tìm Part "2" và "5" ở bất cứ đâu bên trong Model
                local emf_2 = item:FindFirstChild("2", true)
                local emf_5 = item:FindFirstChild("5", true)
                
                if emf_2 and emf_2:IsA("BasePart") then
                    if emf_2.Color == activeColor then
                        emf_active_timers[item] = (emf_active_timers[item] or 0) + 0.5
                        if emf_active_timers[item] >= 2.5 and not ghost_room_found then
                            for _, room in pairs(rooms:GetChildren()) do
                                local hitbox = room:FindFirstChild("Hitbox")
                                -- Handle có thể bị đổi tên hoặc lồng trong Model khi cầm trên tay
                                local handle = item:FindFirstChild("Handle", true) or item.PrimaryPart
                                
                                if hitbox and handle then
                                    if (handle.Position - hitbox.Position).Magnitude < 7 then
                                        ghost_room = hitbox.CFrame
                                        ghost_room_label:SetText("Ghost Room: " .. room.Name)
                                        library:Notify("Ghost Room Identified: " .. room.Name)
                                        ghost_room_found = true
                                        break
                                    end
                                end
                            end
                        end
                    else
                        emf_active_timers[item] = 0
                    end
                end

                -- EMF 5
                if emf_5 and emf_5:IsA("BasePart") and emf_5.Color == activeColor and not found_emf then
                    found_emf = true
                    emf_label:SetText("EMF 5: Yes")
                    library:Notify("Evidence: EMF Level 5!")
                    updateGhostType()
                end
            end
            

            -- C. LOGIC THERMOMETER (Sửa lỗi không quét được trên tay)
            if item.Name == "Thermometer" or item:FindFirstChild("Temp") then
                -- Tìm TextLabel sâu bên trong Model (cầm trên tay cấu trúc hay bị lồng Handle)
                local tempLabel = item:FindFirstChildWhichIsA("TextLabel", true)
                
                if tempLabel and tempLabel.IsA(tempLabel, "TextLabel") then
                    local text = tempLabel.Text
                    -- Lọc lấy số (chấp nhận cả số âm và số thập phân)
                    local tempNum = tonumber(text:match("[-%d.]+"))
                    
                    if tempNum and tempNum < 0 and not got_freezing then
                        got_freezing = true
                        freezing_label:SetText("Freezing: Yes")
                        library:Notify("Evidence: Freezing (" .. tempNum .. "°C)")
                        updateGhostType()
                    end
                end
            end
        end 
    end
end)







game_group:AddButton({
    Text = 'Tp Motion Sensor To Ghost',

    Func = function()
        local motion_grid = evidence_folder.MotionGrids:FindFirstChild("SensorGrid")

        if motion_grid then
            library:Notify("Teleporting Motion Grids to the ghost...")
            local last_pos = {}

            for _, motion_grids in pairs(motion_grid:GetChildren()) do
                if motion_grids:IsA("Part") then
                    last_pos[motion_grids] = motion_grids.CFrame
                    local ghost = workspace.NPCs:FindFirstChildOfClass("Model")
                    motion_grids.CFrame = ghost.HumanoidRootPart.CFrame + Vector3.new(1, 0, 0)
                end
            end
        
            task.wait()
        
            for v, pos in pairs(last_pos) do
                v.CFrame = pos
            end
        end

        if not motion_grid then
            library:Notify("Motion Grids not found place one before using this feature!")
        end
    end,
    DoubleClick = false,
    Tooltip = 'Teleports Motion Grids to the ghost to check for motion'
})

game_group:AddDivider()

game_group:AddButton({
    Text = 'Tp To Van',

    Func = function()
        local_player.Character.HumanoidRootPart.CFrame = van.PrimaryPart.CFrame + Vector3.new(0, 5, 0)
    end,
    DoubleClick = false,
    Tooltip = 'Teleports you to the van'
})

game_group:AddButton({
    Text = 'Tp To Ghost Room',

    Func = function()
        if ghost_room then
            local_player.Character.HumanoidRootPart.CFrame = ghost_room
        else
            Library:Notify("Ghost room not found")
        end
    end,
    DoubleClick = false,
    Tooltip = 'Teleports you to the ghost room'
})

game_group:AddButton({
    Text = 'Teleport to Ghost Room',
    Func = function()
        if ghost_room_pos then
            local character = local_player.Character
            if character and character:FindFirstChild("HumanoidRootPart") then
                -- Teleport đến vị trí đã lưu từ con ma + cao lên 3 unit
                character.HumanoidRootPart.CFrame = ghost_room_pos + Vector3.new(0, 3, 0)
                library:Notify("Teleported to Ghost Room!")
            end
        else
            library:Notify("Ghost Room not found yet! Wait for ghost to spawn.")
        end
    end,
    DoubleClick = false,
    Tooltip = 'Teleports you to the identified ghost room'
})



game_group:AddDivider()

game_group:AddToggle('anti_ghost_touch', {
    Text = 'Anti Ghost Touch',
    Default = false,
    Tooltip = 'Prevents you from touching the ghost and dying',

    Callback = function(Value)
        anti_touch = Value
    end,
}):AddKeyPicker('anti_touch_keybind', {
    Default = '',
    SyncToggleState = true,
    Mode = 'Toggle',
    Text = 'Anti Touch Ghost',
    NoUI = false,
    Callback = function()
    end,
})

game_group:AddSlider('anti_touch_distance', {
    Text = 'Anti Touch Distance',
    Default = 7,
    Min = 7,
    Max = 12,
    Rounding = 1,
    Compact = false,

    Callback = function(Value)
        touch_distance = Value
    end
})







objquest_group:AddDivider()

-- Hàm hỗ trợ ngắt dòng sau mỗi 18 ký tự
local function wrapText(str, limit)
    limit = limit or 32
    if #str <= limit then return str end
    
    local lines = {}
    for i = 1, #str, limit do
        table.insert(lines, str:sub(i, i + limit - 1))
    end
    return table.concat(lines, "\n")
end

-- Khai báo các Label trong Group
local obj_label_11 = objquest_group:AddLabel('')
local obj_label_1 = objquest_group:AddLabel('Objective 1: Waiting...')
local obj_label_12 = objquest_group:AddLabel('')
objquest_group:AddDivider()
local obj_label_21 = objquest_group:AddLabel('')
local obj_label_2 = objquest_group:AddLabel('Objective 2: Waiting...')
local obj_label_22 = objquest_group:AddLabel('')
objquest_group:AddDivider()
local obj_label_31 = objquest_group:AddLabel('')
local obj_label_3 = objquest_group:AddLabel('Objective 3: Waiting...')
local obj_label_32 = objquest_group:AddLabel('')

task.spawn(function()
    while true do
        task.wait(1)
        
        local vanObjectives = workspace:FindFirstChild("Van") 
            and workspace.Van:FindFirstChild("Objectives") 
            and workspace.Van.Objectives:FindFirstChild("SurfaceGui")
            and workspace.Van.Objectives.SurfaceGui:FindFirstChild("Frame")
            and workspace.Van.Objectives.SurfaceGui.Frame:FindFirstChild("Objectives")

        if vanObjectives then
            for i = 1, 3 do
                local objectivePart = vanObjectives:FindFirstChild(tostring(i))
                if objectivePart and objectivePart:IsA("TextLabel") then
                    local currentLabel = (i == 1 and obj_label_1) or (i == 2 and obj_label_2) or obj_label_3
                    
                    -- Màu hoàn thành: 85, 170, 127
                    local completedColor = Color3.fromRGB(85, 170, 127)
                    local currentColor = objectivePart.TextColor3
                    local diff = math.abs(currentColor.R - completedColor.R) + math.abs(currentColor.G - completedColor.G) + math.abs(currentColor.B - completedColor.B)
                    
                    if diff < 0.02 then
                        currentLabel:SetText("Objective " .. i .. ":\n  > > Completed < <")
                    else
                        -- Áp dụng Wrap Text cho nội dung nhiệm vụ dài
                        local formattedText = wrapText(objectivePart.Text, 32)
                        currentLabel:SetText("Objective " .. i .. ":\n" .. formattedText)
                    end
                end
            end
        else
            obj_label_1:SetText("Objective 1: Van Closed")
            obj_label_2:SetText("Objective 2: Van Closed")
            obj_label_3:SetText("Objective 3: Van Closed")
        end
    end
end)









player_group:AddDivider()

player_group:AddToggle('no_hold', {
    Text = 'No Hold',
    Default = false,
    Tooltip = 'Removes hold time from proximityprompts',

    Callback = function(Value)
        no_hold = Value
    end
})

player_group:AddToggle('third_person', {
    Text = '3rd Person',
    Default = false,
    Tooltip = 'Change camera to 3rd person',

    Callback = function(Value)
        third_person = Value
        if Value then
            local_player.Character.Humanoid.CameraOffset = Vector3.new(0, 1, 2)
        else
            local_player.Character.Humanoid.CameraOffset = Vector3.new(0, 0, -1)
        end
    end,
}):AddKeyPicker('third_person_keybind', {
    Default = '',
    SyncToggleState = true,
    Mode = 'Toggle',
    Text = '3rd Person',
    NoUI = false,
    Callback = function()
    end,
})

player_group:AddToggle('allow_jumping', {
    Text = 'Enable Jumping',
    Default = false,
    Tooltip = 'Lets you jump',

    Callback = function(Value)
        jump_enabled = Value
        if Value then
            local_player.Character.Humanoid.JumpPower = 30
            local_player.Character.Humanoid.JumpHeight = 7.2
        else
            local_player.Character.Humanoid.JumpPower = 0
            local_player.Character.Humanoid.JumpHeight = 0
        end
    end
})

player_group:AddToggle('inf_jump', {
    Text = 'Infinite Jump',
    Default = false,
    Tooltip = 'Lets you jump forever',

    Callback = function(Value)
        inf_jump = Value
    end
})

player_group:AddToggle('no_clip', {
    Text = 'No Clip',
    Default = false,
    Tooltip = 'Lets you clip through walls',

    Callback = function(Value)
        noclip = Value
        if not Value then
            local_player.Character.HumanoidRootPart.CanCollide = true
            local_player.Character.UpperTorso.CanCollide = true
            local_player.Character.LowerTorso.CanCollide = true
            local_player.Character.Head.CanCollide = true
        end
    end
})

player_group:AddDivider()

player_group:AddToggle('inf_stamina', {
    Text = 'Infinite Stamina',
    Default = false,
    Tooltip = 'Gives you inf stamina',

    Callback = function(Value)
        inf_stamina = Value
    end
})

player_group:AddToggle('speed sprint modify', {
    Text = 'Speed Sprint Changer',
    Default = false,
    Tooltip = 'Changes how fast you sprint',

    Callback = function(Value)
        speed_sprint = Value
    end
})

player_group:AddSlider('sprint_speed', {
    Text = 'Sprint Speed',
    Default = 1,
    Min = 0.1,
    Max = 10,
    Rounding = 1,
    Compact = false,

    Callback = function(Value)
        sprint_speed = Value
    end
})

player_group:AddDivider()

if map:GetAttribute("MapName") == "Cargo" then
    player_group:AddLabel("Unlocks Plunge Badge With Skin On Click (Run This Before Round Start Or You Will Die.)", true)
    player_group:AddButton({
        Text = 'Unlock Easeter Egg',
    
        Func = function()
            local easter_egg = map:FindFirstChild("EE"):FindFirstChild("Jump"):FindFirstChildOfClass("ProximityPrompt")
            if easter_egg then
                local last_pos = local_player.Character.HumanoidRootPart.CFrame
                local_player.Character.HumanoidRootPart.CFrame = easter_egg.Parent.CFrame
                task.wait(0.1)
                local_player.Character.HumanoidRootPart.CFrame = last_pos
                fireproximityprompt(easter_egg)
                library:Notify("Unlocked Plunge Easeter Egg")
            else
                library:Notify("Plunge Easter Egg Not Found?? (Report On Discord)")
            end
        end,
        DoubleClick = false,
        Tooltip = 'Unlocks Plunge Badge With Skin'
    })
elseif map:GetAttribute("MapName") == "Luxury Home" then
    player_group:AddLabel("Unlocks The Laptop Badge With Skin On Click", true)
    player_group:AddButton({
        Text = 'Unlock Easeter Egg',
    
        Func = function()
            local laptop = map:FindFirstChild("EE"):FindFirstChild("Laptop"):FindFirstChild("Screen"):FindFirstChildOfClass("ProximityPrompt")
            if laptop then
                local last_pos = local_player.Character.HumanoidRootPart.CFrame
                local_player.Character.HumanoidRootPart.CFrame = laptop.Parent.CFrame
                task.wait(0.1)
                fireproximityprompt(laptop)
                local_player.Character.HumanoidRootPart.CFrame = last_pos
                library:Notify("Unlocked Laptop Easeter Egg")
            else
                library:Notify("Laptop not found?? (Report On Discord)")
            end
        end,
        DoubleClick = false,
        Tooltip = 'Unlocks Laptop Badge With Skin'
    })
elseif map:FindFirstChild("EE") then
    player_group:AddLabel("Found Easter Egg On This Map But Is Not Supported", true)
else
    player_group:AddLabel("No Easter Eggs Found On This Map", true)
end

ghost_esp_group:AddToggle('always_show', {
    Text = 'Always Show Ghost',
    Default = false,
    Tooltip = 'Shows the ghost at all times',

    Callback = function(Value)
        show_ghost = Value
        if not Value then
            for _, v in next, ghost:GetChildren() do
                if v:IsA("Model") then
                    v:FindFirstChildOfClass("MeshPart").Transparency = 1
                end
            end
        end
    end
})

ghost_esp_group:AddToggle('ghost_name', {
    Text = 'Ghost Name Esp',
    Default = false,
    Tooltip = 'Shows the ghost name',

    Callback = function(Value)
        ghost_name = Value
        if not Value then
            for _, v in next, ghost:GetChildren() do
                if v:IsA("Model") and v:FindFirstChild("Esp BillBoard") then
                    v:FindFirstChild("Esp BillBoard"):Destroy()
                end
            end
        end
    end
})

ghost_esp_group:AddToggle('highlight_ghost', {
    Text = 'Highlight Ghost',
    Default = false,
    Tooltip = 'Highlights the ghost',

    Callback = function(Value)
        highlight_ghost = Value
        if not Value then
            for _, v in next, ghost:GetChildren() do
                if v:IsA("Model") and v:FindFirstChild("Highlight") then
                    v:FindFirstChild("Highlight"):Destroy()
                end
            end
        end
    end
}):AddColorPicker('highlight_color_ghost', {
    Default = Color3.fromRGB(255, 255, 255),
    Title = 'Highlight Color',

    Callback = function(Value)
        highlight_color_ghost = Value
        for _, v in next, ghost:GetChildren() do
            if v:IsA("Model") and v:FindFirstChild("Highlight") then
                v:FindFirstChild("Highlight").FillColor = Value
                v:FindFirstChild("Highlight").OutlineColor = Value
            end
        end
    end
})

player_esp_group:AddToggle('player_name', {
    Text = 'Player Name Esp',
    Default = false,
    Tooltip = 'Shows the player name',

    Callback = function(Value)
        player_name = Value
        if not Value then
            for _, v in next, players:GetPlayers() do
                if v.Character and v.Character:FindFirstChild("Head") then
                    local esp_billboard = v.Character.Head:FindFirstChild("Esp BillBoard")
                    if esp_billboard then
                        espbillboard:Destroy()
                    end
                end
            end
        end
    end
})

player_esp_group:AddToggle('highlight_player', {
    Text = 'Highlight Player',
    Default = false,
    Tooltip = 'Highlights the player',

    Callback = function(Value)
        player_highlight = Value
        if not Value then
            for _, v in next, players:GetPlayers() do
                if v.Character and v.Character:FindFirstChild("Highlight") then
                    local highlight = v.Character:FindFirstChild("Highlight")
                    if highlight then
                        highlight:Destroy()
                    end
                end
            end
        end
    end
}):AddColorPicker('highlight_color_player', {
    Default = Color3.fromRGB(255, 255, 255),
    Title = 'Highlight Color',

    Callback = function(Value)
        player_highlight_color = Value
        for _, v in next, players:GetPlayers() do
            if v.Character and v.Character:FindFirstChild("Highlight") then
                local highlight = v.Character:FindFirstChild("Highlight")
                if highlight then
                    highlight.FillColor = Value
                    highlight.OutlineColor = Value
                end
            end
        end
    end
})

item_esp_group:AddToggle('item_name', {
    Text = 'Item Name Esp',
    Default = false,
    Tooltip = 'Shows the item name',

    Callback = function(Value)
        item_name = Value
        if not Value then
            for _, tool in next, van_equipment:GetChildren() do
                if tool:IsA("Model") and tool:FindFirstChild("Esp BillBoard") then
                    tool:FindFirstChild("Esp BillBoard"):Destroy()
                end
            end

            for _, tool in next, dropped_equipment:GetChildren() do
                if tool:IsA("Model") and tool:FindFirstChild("Esp BillBoard") then
                    tool:FindFirstChild("Esp BillBoard"):Destroy()
                end
            end
        end
    end
})

item_esp_group:AddToggle('highlight_item', {
    Text = 'Highlight Item',
    Default = false,
    Tooltip = 'Highlights the item',

    Callback = function(Value)
        item_highlight = Value
        if not Value then
            for _, tool in next, van_equipment:GetChildren() do
                if tool:IsA("Model") and tool:FindFirstChild("Highlight") then
                    tool:FindFirstChild("Highlight"):Destroy()
                end
            end

            for _, tool in next, dropped_equipment:GetChildren() do
                if tool:IsA("Model") and tool:FindFirstChild("Highlight") then
                    tool:FindFirstChild("Highlight"):Destroy()
                end
            end
        end
    end
}):AddColorPicker('highlight_color_item', {
    Default = Color3.fromRGB(255, 255, 255),
    Title = 'Highlight Color',

    Callback = function(Value)
        item_highlight_color = Value
        for _, v in next, van_equipment:GetChildren() do
            if v:IsA("Model") and v:FindFirstChild("Highlight") then
                v:FindFirstChild("Highlight").FillColor = Value
                v:FindFirstChild("Highlight").OutlineColor = Value
            end
        end

        for _, v in next, dropped_equipment:GetChildren() do
            if v:IsA("Model") and v:FindFirstChild("Highlight") then
                v:FindFirstChild("Highlight").FillColor = Value
                v:FindFirstChild("Highlight").OutlineColor = Value
            end
        end
    end
})

cursed_esp_group:AddToggle('cursed_object_name', {
    Text = 'Cursed Object Name',
    Default = false,
    Tooltip = 'Shows the cursed object name',

    Callback = function(Value)
        cursed_object_name = Value
        if not Value then
            for _, v in next, cursed_objects:GetChildren() do
                if (v:IsA("MeshPart") or v:IsA("Model") or v:IsA("Part")) and not (v.Name == "Chair" or v.Name == "Body") and v:FindFirstChild("Esp BillBoard") then
                    v:FindFirstChild("Esp BillBoard"):Destroy()
                end
            end
        end
    end
})

cursed_esp_group:AddToggle('cursed_object_highlight', {
    Text = 'Cursed Object Highlight',
    Default = false,
    Tooltip = 'Highlights cursed objects',

    Callback = function(Value)
        cursed_object_highlight = Value
        if not Value then
            for _, v in next, cursed_objects:GetChildren() do
                if (v:IsA("MeshPart") or v:IsA("Model") or v:IsA("Part")) and v:FindFirstChild("Highlight") then
                    v.Highlight:Destroy()
                end
            end
        end
    end
}):AddColorPicker('cursed_object_highlight_color', {
    Default = Color3.fromRGB(255, 255, 255),
    Title = 'Highlight Color',

    Callback = function(Value)
        cursed_object_highlight_color = Value
        for _, v in next, cursed_objects:GetChildren() do
            if (v:IsA("MeshPart") or v:IsA("Model") or v:IsA("Part")) and v:FindFirstChild("Highlight") then
                v.Highlight.FillColor = Value
                v.Highlight.OutlineColor = Value
            end
        end
    end
})

evidence_esp_group:AddToggle('emf_name', {
    Text = 'Show Active EMFs',
    Default = false,
    Tooltip = 'Shows active EMFs done by ghost',

    Callback = function(Value)
        emf_name = Value
        if not Value then
            for i, v in next, emfs:GetChildren() do
                if v:IsA("Part") and v:FindFirstChild("Esp BillBoard") then
                    v:FindFirstChild("Esp BillBoard"):Destroy()
                end
            end
        end
    end
})

evidence_esp_group:AddToggle('orbs_name', {
    Text = 'Show Active Orbs',
    Default = false,
    Tooltip = 'Shows active orbs',

    Callback = function(Value)
        orbs_name = Value
        if not Value then
            for i, v in next, orbs:GetChildren() do
                if v:IsA("Part") and v:FindFirstChild("Esp BillBoard") then
                    v:FindFirstChild("Esp BillBoard"):Destroy()
                end
            end
        end
    end
})

closet_esp_group:AddToggle('closet_name', {
    Text = 'Hiding Spot Esp Name',
    Default = false,
    Tooltip = 'Enables names to all closets',

    Callback = function(Value)
        closet_name = Value
        if not Value then
            for i, v in next, closets:GetChildren() do
                if v:IsA("Model") and v:FindFirstChild("Esp BillBoard") then
                    v:FindFirstChild("Esp BillBoard"):Destroy()
                end
            end
        end
    end
})

closet_esp_group:AddToggle('closet_highlight', {
    Text = 'Hiding Spot Esp Highlight',
    Default = false,
    Tooltip = 'Highlights closets',

    Callback = function(Value)
        closet_highlight = Value
        if not Value then
            for i, v in next, closets:GetChildren() do
                if v:IsA("Model") and v:FindFirstChild("Highlight") then
                    v.Highlight:Destroy()
                end
            end
        end
    end
}):AddColorPicker('closet_highlight_color', {
    Default = Color3.fromRGB(255, 255, 255),
    Title = 'Highlight Color',

    Callback = function(Value)
        closet_highlight_color = Value
        for i, v in next, closets:GetChildren() do
            if v:IsA("Model") and v:FindFirstChild("Highlight") then
                v.Highlight.FillColor = Value
                v.Highlight.OutlineColor = Value
            end
        end
    end
})

world_group:AddToggle('fb', {
    Text = 'Full Bright',
    Default = false,
    Tooltip = 'full bright like cat!',

    Callback = function(Value)
        full_bright = Value
        if Value then
            lighting.ClockTime = 12
            lighting.GlobalShadows = false
        else
            lighting.ClockTime = 0
            lighting.GlobalShadows = true
        end
    end
})

local colorCorrection = Instance.new("ColorCorrectionEffect")
colorCorrection.Name = "😘"
colorCorrection.Saturation = 0
colorCorrection.Parent = game.Lighting

world_group:AddToggle('saturation', {
    Text = 'Increase Color Saturation',
    Default = false,
    Tooltip = 'Makes the world colors more vivid',
    Callback = function(Value)
        if Value then
            colorCorrection.Saturation = 0.75
        else
            colorCorrection.Saturation = 0
        end
    end
})

world_group:AddToggle('nf', {
    Text = 'No Fog',
    Default = false,
    Tooltip = 'Removes fog',

    Callback = function(Value)
        nofog = Value
        if Value then
            lighting.FogEnd = 1000000
            lighting.FogStart = 0
        else
            lighting.FogEnd = 1000
            lighting.FogStart = 0
        end
    end
})

world_group:AddDivider()

world_group:AddButton({
    Text = "Day",
    Func = function() lighting.ClockTime = 12 end
})
world_group:AddButton({
    Text = "Night",
    Func = function() lighting.ClockTime = 0 end
})

misc_group:AddButton({
    Text = 'Anti AFK',
    Func = function()
        -- แบบง่ายโดยไม่ต้องใช้ exploit
        local_player.Idled:Connect(function()
            VirtualUser:Button2Down(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
            VirtualUser:Button2Up(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
        end)
        library:Notify("Anti AFK Enabled!")
    end,
    DoubleClick = false,
    Tooltip = 'Won\'t disconnect you after 20 minutes'
})

misc_group:AddButton({
    Text = 'Bypass Anti Cheat',
    Func = function()
        -- แบบง่ายโดยไม่ต้องใช้ exploit
        local_player.Idled:Connect(function()
            VirtualUser:Button2Down(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
            VirtualUser:Button2Up(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
        end)
        library:Notify("Bypass Done!")
    end,
    DoubleClick = false,
    Tooltip = 'Bypass cheat for Safe now!'
})

boost_group:AddButton({
    Text = 'Boost Fps',
    Tooltip = 'Optimize performance and boost FPS',
    DoubleClick = false,

    Func = function()
        local success, err = pcall(function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/dyumra/DYHUB-Universal-Game/refs/heads/main/Nigga.lua"))()
        end)

        if success then
            library:Notify("Boost FPS Enabled!")
        else
            library:Notify("Failed to load Boost FPS:\n" .. tostring(err))
        end
    end
})

misc_group:AddButton({
    Text = 'Infinite Yield',
    Tooltip = 'Give Inf yield has edit',
    DoubleClick = false,

    Func = function()
        local success, err = pcall(function()
                    loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/Xd/refs/heads/main/infedit"))()
        end)

        if success then
            library:Notify("Load Success")
        else
            library:Notify("Failed to load infYield\n" .. tostring(err))
        end
    end
})

boost_group:AddToggle('uf', {
    Text = 'Unlock Fps',
    Default = false,
    Tooltip = 'just unlock fps cap 60 to 360',

    Callback = function(Value)
        fps = Value
        if Value then
            setfpscap(99999999999)
        else
            setfpscap(60)
        end
    end
})

library:SetWatermarkVisibility(true)

local FrameTimer = tick()
local FrameCounter = 0;
local FPS = 60;

local watermark_connection = run_service.RenderStepped:Connect(function()
    FrameCounter += 1;

    if (tick() - FrameTimer) >= 1 then
        FPS = FrameCounter;
        FrameTimer = tick();
        FrameCounter = 0;
    end;

    library:SetWatermark(('IgnahK | %s fps | %s ms | Game: ' .. info.Name .. ''):format(
        math.floor(FPS),
        math.floor(stats.Network.ServerStatsItem['Data Ping']:GetValue())
    ));
end);

menu_group:AddButton('Unload', function()
    anti_touch = false
    no_hold = false
    inf_stamina = false
    speed_sprint = false
    jump_enabled = false
    full_bright = false
    nofog = false
    fps = false
    show_ghost = false
    highlight_ghost = false
    ghost_name = false
    player_name = false
    player_highlight = false
    item_name = false
    item_highlight = false
    cursed_object_highlight = false
    cursed_object_name = false
    orbs_name = false
    emf_name = false
    found_writing = false
    ghost_name = false
    closet_name = false
    closet_highlight = false

    for _, v in next, ghost:GetChildren() do
        if v:IsA("Model") then
            v:FindFirstChildOfClass("MeshPart").Transparency = 1
        end
    end

    for _, esp in next, workspace:GetDescendants() do
        if esp.Name == "Esp BillBoard" or esp.Name == "Highlight" then
            esp:Destroy()
        end
    end

    local_player.Character.Humanoid.JumpPower = 0
    local_player.Character.Humanoid.JumpHeight = 0
    local_player.Character.Humanoid.CameraOffset = Vector3.new(0, 0, -1)
    local_player.Character.HumanoidRootPart.CanCollide = true
    local_player.Character.UpperTorso.CanCollide = true
    local_player.Character.LowerTorso.CanCollide = true
    local_player.Character.Head.CanCollide = true
    lighting.ClockTime = 0
    lighting.GlobalShadows = true
    watermark_connection:Disconnect()
    motionconnection:Disconnect()
    sanityconnection:Disconnect()
    ghostconnection:Disconnect()
    playerconnection:Disconnect()
    library:Unload()
end)

credits_group:AddLabel('Ignahk: Credits', true)


settings_group:AddToggle('keybind_visibility', {
    Text = 'Keybind Visibility',
    Default = false,
    Tooltip = 'Enables/Disables the watermark',

    Callback = function(Value)
        library.KeybindFrame.Visible = Value
    end,
})

menu_group:AddLabel('Menu bind'):AddKeyPicker('MenuKeybind', { Default = 'End', NoUI = true, Text = 'Menu keybind' })
library.ToggleKeybind = Options.MenuKeybind
theme_manager:SetLibrary(library)
save_manager:SetLibrary(library)
save_manager:IgnoreThemeSettings()
save_manager:SetIgnoreIndexes({ 'MenuKeybind' })
theme_manager:SetFolder('DYHUB')
save_manager:SetFolder('DYHUB/Specter')
save_manager:BuildConfigSection(tabs['ui settings'])
theme_manager:ApplyToTab(tabs['ui settings'])

save_manager:LoadAutoloadConfig()







task.spawn(function()



function doDetectHunt()
	spawn(function()
		while getgenv().AutoHD == true do
			for _, v in ipairs(game.SoundService:GetDescendants()) do
				if v.Name == "Hunt" then
					if v.Volume >= 0.1 then
						if AlreadySet == false then
							AlreadySet = true

							                            game:GetService("StarterGui"):SetCore("SendNotification", {
                                Title = "⚠️ WARNING ⚠️",
                                Text = "Hunt Has Started!",
                                Icon = "rbxassetid://4483362458",
                                Duration = 5
                            })
						end
					elseif v.Volume <= 0.3 then
						if AlreadySet == true then
							AlreadySet = false

							                game:GetService("StarterGui"):SetCore("SendNotification", {
                    Title = "✅ SAFE ✅",
                    Text = "Hunt Has Ended!",
                    Duration = 5
                })
						end
					end
				end
			end
			wait(1)
		end
	end)
end





end)