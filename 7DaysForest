-- Kiểm tra ID game
if game.PlaceId ~= 121308443347459 then
    return warn("Script only works in the specified game (ID: 121308443347459){7Days To Live (Forest)}")
end

-- Thông báo khi đúng ID game
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "✓ Game Check Passed",
    Text = "Script is now executing...",
    Duration = 5
})

task.wait(1) -- Đợi 1s trước khi thực thi 

task.spawn(function()
-- Khai báo các dịch vụ cần thiết
local player = game.Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local camera = workspace.CurrentCamera

-- Tải và khởi tạo thư viện GUI Rayfield
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Tạo cửa sổ giao diện chính
local Window = Rayfield:CreateWindow({
    Name = "Script By Khang",
    LoadingTitle = "Loading Hub...",
    LoadingSubtitle = "Please wait",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "MyHubFolder",
        FileName = "MyHubConfig"
    },
    Discord = {
        Enabled = false,
        Invite = "",
        RememberJoins = false
    },
    KeySystem = false,
})

-- Thông báo đã tải
Rayfield:Notify({
    Title = "Welcome!",
    Content = "Script Loaded",
    Duration = 2
})

-- Tạo Tab Main
local MTab = Window:CreateTab("Main", "home")
MTab:CreateSection("Main")

  MTab:CreateButton({
    Name = "Aimbot (Some npc may not work)",
    Callback = function()
      loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/Xd/refs/heads/main/Aimbot%20npc%207%20days"))()
    end,
  })

local autoScrapRunning = false
local savedCFrame = nil

MTab:CreateToggle({
	Name = "Auto Scrap",
	CurrentValue = false,
	Flag = "AutoScrapToggle",
	Callback = function(state)
		local Players = game:GetService("Players")
		local RunService = game:GetService("RunService")
		local lp = Players.LocalPlayer

		autoScrapRunning = state

		if not state then
			Rayfield:Notify({Title = "Auto Scrap", Content = "Auto Scrap disabled", Duration = 2})

			task.delay(1, function()
				local char = lp.Character or lp.CharacterAdded:Wait()
				local hrp = char:FindFirstChild("HumanoidRootPart")
				if hrp and savedCFrame then
					char:PivotTo(savedCFrame)
					Rayfield:Notify({
						Title = "Auto Scrap",
						Content = "Teleported back",
						Duration = 2
					})
				end
			end)

			return
		end

		local function findNextScrap()
			for _, obj in ipairs(workspace:GetDescendants()) do
				if obj:IsA("Model") and obj.Name:lower() == "scrap" then
					local part = obj.PrimaryPart or obj:FindFirstChildWhichIsA("BasePart")
					local prompt = obj:FindFirstChildWhichIsA("ProximityPrompt", true)
						or obj:FindFirstChildWhichIsA("ClickDetector", true)
						or obj:FindFirstChild("TouchInterest", true)

					if part and prompt then
						return part, prompt
					end
				end
			end
			return nil
		end

		local function collectNext()
			if not autoScrapRunning then return end

			local char = lp.Character or lp.CharacterAdded:Wait()
			local hrp = char:WaitForChild("HumanoidRootPart")
			if not savedCFrame then savedCFrame = hrp.CFrame end

			local part, prompt = findNextScrap()

			if not part then
				Rayfield:Notify({Title = "Auto Scrap", Content = "No Scrap found", Duration = 2})
				task.delay(1, collectNext)
				return
			end

			-- Teleport cao hơn để không bị kẹt + chống té
hrp.CFrame = CFrame.new(part.Position + Vector3.new(0, 6.3, 0))
task.wait(0.2)
local humanoid = lp.Character:FindFirstChildOfClass("Humanoid")
if humanoid then
	humanoid.PlatformStand = false
	humanoid.Sit = false
end

			pcall(function()
				if prompt:IsA("ProximityPrompt") then
					fireproximityprompt(prompt)
				elseif prompt:IsA("ClickDetector") then
					fireclickdetector(prompt)
				elseif prompt.Name == "TouchInterest" then
					firetouchinterest(hrp, part, 0)
					task.wait()
					firetouchinterest(hrp, part, 1)
				end
			end)

			task.delay(0.5, collectNext)
		end

		Rayfield:Notify({Title = "Auto Scrap", Content = "Collecting started...", Duration = 2})
		collectNext()
	end
})

local autoScrapRunning = false
local savedCFrame = nil

MTab:CreateToggle({
	Name = "Auto Scrap (Fast)",
	CurrentValue = false,
	Flag = "AutoScrapToggle",
	Callback = function(state)
		local Players = game:GetService("Players")
		local RunService = game:GetService("RunService")
		local lp = Players.LocalPlayer

		autoScrapRunning = state

		if not state then
			Rayfield:Notify({Title = "Auto Scrap", Content = "Auto Scrap disabled", Duration = 2})

			task.delay(1, function()
				local char = lp.Character or lp.CharacterAdded:Wait()
				local hrp = char:FindFirstChild("HumanoidRootPart")
				if hrp and savedCFrame then
					char:PivotTo(savedCFrame)
					Rayfield:Notify({
						Title = "Auto Scrap",
						Content = "Teleported back",
						Duration = 2
					})
				end
			end)

			return
		end

		local function findNextScrap()
			for _, obj in ipairs(workspace:GetDescendants()) do
				if obj:IsA("Model") and obj.Name:lower() == "scrap" then
					local part = obj.PrimaryPart or obj:FindFirstChildWhichIsA("BasePart")
					local prompt = obj:FindFirstChildWhichIsA("ProximityPrompt", true)
						or obj:FindFirstChildWhichIsA("ClickDetector", true)
						or obj:FindFirstChild("TouchInterest", true)

					if part and prompt then
						return part, prompt
					end
				end
			end
			return nil
		end

		local function collectNext()
			if not autoScrapRunning then return end

			local char = lp.Character or lp.CharacterAdded:Wait()
			local hrp = char:WaitForChild("HumanoidRootPart")
			if not savedCFrame then savedCFrame = hrp.CFrame end

			local part, prompt = findNextScrap()

			if not part then
				Rayfield:Notify({Title = "Auto Scrap", Content = "No Scrap found", Duration = 2})
				task.delay(1, collectNext)
				return
			end

			-- Teleport cao hơn để không bị kẹt + chống té
hrp.CFrame = CFrame.new(part.Position + Vector3.new(0, 6.3, 0))
task.wait(0.2)
local humanoid = lp.Character:FindFirstChildOfClass("Humanoid")
if humanoid then
	humanoid.PlatformStand = false
	humanoid.Sit = false
end

			pcall(function()
				if prompt:IsA("ProximityPrompt") then
					fireproximityprompt(prompt)
				elseif prompt:IsA("ClickDetector") then
					fireclickdetector(prompt)
				elseif prompt.Name == "TouchInterest" then
					firetouchinterest(hrp, part, 0)
					task.wait()
					firetouchinterest(hrp, part, 1)
				end
			end)

			task.delay(0.2, collectNext)
		end

		Rayfield:Notify({Title = "Auto Scrap", Content = "Collecting started...", Duration = 2})
		collectNext()
	end
})

local autoHeal = false

MTab:CreateToggle({
    Name = "Auto Heal Players",
    CurrentValue = false,
    Flag = "AutoHealPlayers",
    Callback = function(Value)
        autoHeal = Value
        if autoHeal then
            task.spawn(function()
                while autoHeal do
                    for _, player in ipairs(game:GetService("Players"):GetPlayers()) do
                        local char = player.Character
                        if char and char:FindFirstChild("Humanoid") and char:FindFirstChild("HumanoidRootPart") then
                            local hp = char.Humanoid.Health
                            local maxHp = char.Humanoid.MaxHealth
                            if hp < maxHp then
                                local args = { char }
                                game:GetService("ReplicatedStorage"):WaitForChild("remotes"):WaitForChild("heal"):FireServer(unpack(args))
                            end
                        end
                    end
                    task.wait(0.5)
                end
            end)
        end
    end,
})

local autoFishingRunning = false
local autoFishingConnection

MTab:CreateToggle({
	Name = "Auto fishing [Fishing Rod]",
	CurrentValue = false,
	Flag = "AutoFishingToggle",
	Callback = function(state)
		autoFishingRunning = state

		if autoFishingConnection then
			autoFishingConnection:Disconnect()
			autoFishingConnection = nil
		end

		if state then
			autoFishingConnection = task.spawn(function()
				while autoFishingRunning do
					game:GetService("ReplicatedStorage"):WaitForChild("remotes"):WaitForChild("cast"):FireServer()
wait(1)

for i = 1, 8 do
game:GetService("ReplicatedStorage"):WaitForChild("remotes"):WaitForChild("hit_fish"):FireServer()
task.wait(0.05)
end
wait(0.5)
game:GetService("ReplicatedStorage"):WaitForChild("remotes"):WaitForChild("finished_tutorial"):FireServer()

					
					task.wait(0.1) -- mỗi lần cách 0.1 giây
				end
			end)
		end
	end
})

MTab:CreateSection("Get Berry")

MTab:CreateButton({
    Name = "Eat Berry Button (Full Hungry)",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/7DayToLive/refs/heads/main/EatBerryButton"))()
    end,
})

local toggleRunning = false
local connection

MTab:CreateToggle({
	Name = "GetBerry [INF]",
	CurrentValue = false,
	Flag = "GetBerryINF",
	Callback = function(state)
		toggleRunning = state

		local lp = game:GetService("Players").LocalPlayer
		local RunService = game:GetService("RunService")

		if connection then
			connection:Disconnect()
			connection = nil
		end

		local char = lp.Character or lp.CharacterAdded:Wait()
		local hrp = char:WaitForChild("HumanoidRootPart")
		local hum = char:FindFirstChildOfClass("Humanoid")
		if not (hrp and hum) then return end

		local originalCFrame = hrp.CFrame

		if not state then
			char:PivotTo(originalCFrame)
			return
		end

		connection = RunService.Heartbeat:Connect(function()
			if not toggleRunning then return end

			char = lp.Character or lp.CharacterAdded:Wait()
			hrp = char:FindFirstChild("HumanoidRootPart")
			hum = char:FindFirstChildOfClass("Humanoid")
			if not (hrp and hum) then return end

			local nearestBerry, shortestDist = nil, math.huge
			for _, obj in ipairs(workspace:GetDescendants()) do
				if obj:IsA("Model") and obj.Name:lower() == "berry" then
					local part = obj.PrimaryPart or obj:FindFirstChildWhichIsA("BasePart")
					if part then
						local dist = (hrp.Position - part.Position).Magnitude
						if dist < shortestDist then
							nearestBerry = obj
							shortestDist = dist
						end
					end
				end
			end

			if nearestBerry then
				local part = nearestBerry.PrimaryPart or nearestBerry:FindFirstChildWhichIsA("BasePart")
				if not nearestBerry.PrimaryPart and part then
					pcall(function()
						nearestBerry.PrimaryPart = part
					end)
				end

				local prompt = nearestBerry:FindFirstChildWhichIsA("ProximityPrompt", true)
					or nearestBerry:FindFirstChildWhichIsA("ClickDetector", true)
					or nearestBerry:FindFirstChild("TouchInterest", true)

				if prompt and part then
					char:PivotTo(part.CFrame + Vector3.new(0, 7, 0))
					task.wait(0.25)

					for i = 1, 50 do
						pcall(function()
							if prompt:IsA("ProximityPrompt") then
								fireproximityprompt(prompt)
							elseif prompt:IsA("ClickDetector") then
								fireclickdetector(prompt)
							elseif prompt.Name == "TouchInterest" then
								firetouchinterest(hrp, part, 0)
								task.wait()
								firetouchinterest(hrp, part, 1)
							end
						end)
						task.wait(0.05)
					end

					task.wait(0.2)
					char:PivotTo(originalCFrame)
					task.wait(1) -- Chờ 1 giây trước lần lặp kế tiếp
				end
			else
				task.wait(1)
			end
		end)
	end
})

MTab:CreateButton({
	Name = "GetBerry [30/04/1975]",
	Callback = function()
		local lp = game:GetService("Players").LocalPlayer
		local char = lp.Character or lp.CharacterAdded:Wait()
		local hrp = char:WaitForChild("HumanoidRootPart")
		local hum = char:FindFirstChildOfClass("Humanoid")
		if not (hrp and hum) then return end

		local originalCFrame = hrp.CFrame

		local nearestBerry, shortestDist = nil, math.huge
		for _, obj in ipairs(workspace:GetDescendants()) do
			if obj:IsA("Model") and obj.Name:lower() == "berry" then
				local part = obj.PrimaryPart or obj:FindFirstChildWhichIsA("BasePart")
				if part then
					local dist = (hrp.Position - part.Position).Magnitude
					if dist < shortestDist then
						nearestBerry = obj
						shortestDist = dist
					end
				end
			end
		end

		if nearestBerry then
			local part = nearestBerry.PrimaryPart or nearestBerry:FindFirstChildWhichIsA("BasePart")
			if not nearestBerry.PrimaryPart and part then
				pcall(function()
					nearestBerry.PrimaryPart = part
				end)
			end

			local prompt = nearestBerry:FindFirstChildWhichIsA("ProximityPrompt", true)
				or nearestBerry:FindFirstChildWhichIsA("ClickDetector", true)
				or nearestBerry:FindFirstChild("TouchInterest", true)

			if prompt and part then
				-- TP 1 lần
				char:PivotTo(part.CFrame + Vector3.new(0, 7, 0))
				task.wait(0.25)

				-- Nhặt đủ số lần tại chỗ
				for i = 1, 6095 do
					pcall(function()
						if prompt:IsA("ProximityPrompt") then
							fireproximityprompt(prompt)
						elseif prompt:IsA("ClickDetector") then
							fireclickdetector(prompt)
						elseif prompt.Name == "TouchInterest" then
							firetouchinterest(hrp, part, 0)
							task.wait()
							firetouchinterest(hrp, part, 1)
						end
					end)
				end

				-- TP về chỗ cũ
				task.wait(0.2)
				char:PivotTo(originalCFrame)
			end
		end
	end
})

MTab:CreateInput({
	Name = "Collect Berry (Input berry number)",
	PlaceholderText = "Enter quantity (100000 MAX)",
	RemoveTextAfterFocusLost = false,
	Callback = function(text)
		local amount = tonumber(text)
		if not amount or amount <= 0 then
			warn("Số không hợp lệ")
			return
		end

		-- Giới hạn tối đa 100000 berry
		if amount > 100000 then
			amount = 100000
		end

		-- Làm tròn lên bội số của 5
		local rounded = math.ceil(amount / 5) * 5
		local repeatCount = rounded / 5

		local lp = game:GetService("Players").LocalPlayer
		local char = lp.Character or lp.CharacterAdded:Wait()
		local hrp = char:WaitForChild("HumanoidRootPart")
		local hum = char:FindFirstChildOfClass("Humanoid")
		if not (hrp and hum) then return end

		local originalCFrame = hrp.CFrame

		local nearestBerry, shortestDist = nil, math.huge
		for _, obj in ipairs(workspace:GetDescendants()) do
			if obj:IsA("Model") and obj.Name:lower() == "berry" then
				local part = obj.PrimaryPart or obj:FindFirstChildWhichIsA("BasePart")
				if part then
					local dist = (hrp.Position - part.Position).Magnitude
					if dist < shortestDist then
						nearestBerry = obj
						shortestDist = dist
					end
				end
			end
		end

		if nearestBerry then
			local part = nearestBerry.PrimaryPart or nearestBerry:FindFirstChildWhichIsA("BasePart")
			if not nearestBerry.PrimaryPart and part then
				pcall(function()
					nearestBerry.PrimaryPart = part
				end)
			end

			local prompt = nearestBerry:FindFirstChildWhichIsA("ProximityPrompt", true)
				or nearestBerry:FindFirstChildWhichIsA("ClickDetector", true)
				or nearestBerry:FindFirstChild("TouchInterest", true)

			if prompt and part then
				char:PivotTo(part.CFrame + Vector3.new(0, 7, 0))
				task.wait(0.25)

				for i = 1, repeatCount do
					pcall(function()
						if prompt:IsA("ProximityPrompt") then
							fireproximityprompt(prompt)
						elseif prompt:IsA("ClickDetector") then
							fireclickdetector(prompt)
						elseif prompt.Name == "TouchInterest" then
							firetouchinterest(hrp, part, 0)
							task.wait()
							firetouchinterest(hrp, part, 1)
						end
					end)
				end

				task.wait(0.2)
				char:PivotTo(originalCFrame)
			end
		end
	end
})












-- Tạo Tab Visual
local VTab = Window:CreateTab("Visual", "eye")
VTab:CreateSection("Main Visual")

VTab:CreateButton({
    Name = "Players ESP",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/7DayToLive/refs/heads/main/Playeresp"))()
    end,
})

-- Esp home button (Rayfield GUI - MTab)
VTab:CreateButton({
    Name = "Home",
    Callback = function()
       
    end
})

VTab:CreateButton({
    Name = "Animal and Monster",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/7DayToLive/refs/heads/main/Esp%20Npc"))()
    end,
})

VTab:CreateButton({
    Name = "Easter egg (Fishing)",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/7DayToLive/refs/heads/main/Eastereggesp"))()
    end,
})












local TeleportTab = Window:CreateTab("Teleport", "map")
TeleportTab:CreateSection("Main Location")

-- Vị trí chính
local locations = {
    {Name = "Home", Position = Vector3.new(60.99, 48.58, 417.10)},
    {Name = "Home balcony", Position = Vector3.new(37.34, 52.72, 420.62)},
    {Name = "Home roof", Position = Vector3.new(57.73, 68.46, 417.58)},
    {Name = "River", Position = Vector3.new(-227.99, -0.84, 341.59)},
    {Name = "Skeleton", Position = Vector3.new(145.43, 12.63, 234.22)},
    {Name = "Turret1", Position = Vector3.new(-110.91, 37.91, 352.01)},
    {Name = "Turret2", Position = Vector3.new(-5.95, 26.77, 258.23)},
    {Name = "Turret3", Position = Vector3.new(117.83, 34.97, 336.75)},
    {Name = "Turret4", Position = Vector3.new(95.04, 34.41, 491.53)},
    {Name = "Helicopter (Waiting to appear)", Position = Vector3.new(-318.54, 30.69, -110.7)},
}

for _, loc in ipairs(locations) do
    TeleportTab:CreateButton({
        Name = "Go to " .. loc.Name,
        Callback = function()
            local hrp = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if hrp then
                hrp.CFrame = CFrame.new(loc.Position)
            end
        end
    })
end









local KTab = Window:CreateTab("Misc", "package")
  
KTab:CreateButton({
    Name = "Collect Aura",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/Xd/refs/heads/main/CollectAura"))()
    end,
})
  
  KTab:CreateButton({
    Name = "Inf Yield Edit",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/Xd/refs/heads/main/infedit"))()
    end,
  })

KTab:CreateButton({
     Name = "Herkle Hub",
     Callback = function()
         loadstring(game:HttpGet("https://raw.githubusercontent.com/decryp1/Herkle-Hub/refs/heads/main/game%20redirect"))()
     end,
})

KTab:CreateButton({
    Name = "Xomar Hub",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/omaromar242/7-days-Op-omarXwiet-Works/refs/heads/main/.gitignore"))()
task.spawn(function()
if setclipboard then
    setclipboard("wietXomar_Hub") -- thay bằng nội dung cần copy
    print("Copied Key: wietXomar_Hub!")
else
    warn("Executor not supported setclipboard")
end
end)
    end,
})

KTab:CreateButton({
    Name = "Killaura",
    Callback = function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/zamzamzan/test/refs/heads/main/7days'))()
    end,
})

KTab:CreateButton({
    Name = "Dot Aim",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/Xd/refs/heads/main/DotAim"))()
    end,
})

KTab:CreateButton({
    Name = "Enable Chat",
    Callback = function()
        local StarterGui = game:GetService("StarterGui")
local TextChatService = game:GetService("TextChatService")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

-- Bật lại Chat GUI nếu bị tắt
pcall(function()
    StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.Chat, true)
end)

-- Bật lại ChatWindow nếu bị ẩn
local function enableChatWindow()
    local config = TextChatService:FindFirstChild("ChatWindowConfiguration")
    if config then
        config.Enabled = true
    end
end

-- Kiểm tra định kỳ để đảm bảo không bị tắt lại
RunService.RenderStepped:Connect(function()
    if not StarterGui:GetCoreGuiEnabled(Enum.CoreGuiType.Chat) then
        StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.Chat, true)
    end
    enableChatWindow()
end)
    end,
})

KTab:CreateButton({
    Name = "Anti-Void",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/7DayToLive/refs/heads/main/AntiVoid"))()
    end,
})

KTab:CreateSection("Save location")
local originalPos = nil

KTab:CreateButton({
    Name = "Save current location",
    Callback = function()
        local hrp = game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if hrp then
            originalPos = hrp.CFrame
            Rayfield:Notify({
                Title = "Original location",
                Content = "Current location saved",
                Duration = 2
            })
        end
    end,
})

KTab:CreateButton({
    Name = "Return to original position",
    Callback = function()
        local hrp = game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if originalPos and hrp then
            hrp.CFrame = originalPos
            Rayfield:Notify({
                Title = "Teleport",
                Content = "Teleported to saved location",
                Duration = 2
            })
        end
    end,
})
  
end)

task.wait(1) -- Đợi Rayfield load hoàn tất
local function applyFontToRayfieldFonts()
    for _, gui in pairs(game:GetService("CoreGui"):GetDescendants()) do
        if gui:IsA("TextLabel") or gui:IsA("TextButton") or gui:IsA("TextBox") then
            pcall(function()
                gui.Font = Enum.Font.Bodoni
            end)
        end
    end
end

applyFontToRayfieldFonts()