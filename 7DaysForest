-- Kiểm tra ID game
if game.PlaceId ~= 121308443347459 then
    return warn("Script only works in the specified game (ID: 121308443347459){7Days To Live (Forest)}")
end

-- Thông báo khi đúng ID game
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "✓ Game Check Passed",
    Text = "Script is now executing...",
    Duration = 5
})

task.wait(3) -- Đợi 3s trước khi thực thi 

task.spawn(function()
-- Khai báo các dịch vụ cần thiết
local player = game.Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local camera = workspace.CurrentCamera

-- Tải và khởi tạo thư viện GUI Rayfield
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Tạo cửa sổ giao diện chính
local Window = Rayfield:CreateWindow({
    Name = "Script By Khang",
    LoadingTitle = "Loading Hub...",
    LoadingSubtitle = "Please wait",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "MyHubFolder",
        FileName = "MyHubConfig"
    },
    Discord = {
        Enabled = false,
        Invite = "",
        RememberJoins = false
    },
    KeySystem = false,
})

-- Thông báo đã tải
Rayfield:Notify({
    Title = "Welcome!",
    Content = "Script Loaded",
    Duration = 2
})

-- Tạo Tab Main
local MTab = Window:CreateTab("Main", "home")

MTab:CreateSection("Main")

MTab:CreateButton({
    Name = "Esp Npc",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/7DayToLive/refs/heads/main/Esp%20Npc"))()
    end,
})
  
  MTab:CreateButton({
    Name = "Aimbot (Some npc may not work)",
    Callback = function()
      loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/Xd/refs/heads/main/Aimbot%20npc%207%20days"))()
    end,
  })

MTab:CreateToggle({
    Name = "Get Berry (INF)",
    CurrentValue = false,
    Callback = function(state)
        collecting = state

        task.spawn(function()
            local lp = game:GetService("Players").LocalPlayer
            local TweenService = game:GetService("TweenService")

            while collecting do
                local char = lp.Character or lp.CharacterAdded:Wait()
                local hrp = char:FindFirstChild("HumanoidRootPart")
                local hum = char:FindFirstChildOfClass("Humanoid")
                if not hrp or not hum then
                    task.wait(1)
                    continue
                end

                -- Tìm berry gần nhất
                local nearestBerry, shortestDist = nil, math.huge
                for _, obj in ipairs(workspace:GetDescendants()) do
                    if obj:IsA("Model") and obj.Name:lower() == "berry" then
                        local part = obj.PrimaryPart or obj:FindFirstChildWhichIsA("BasePart")
                        if part then
                            local d = (hrp.Position - part.Position).Magnitude
                            if d < shortestDist then
                                nearestBerry, shortestDist = obj, d
                            end
                        end
                    end
                end

                if not nearestBerry then
                    task.wait(0.5)
                    continue
                end

                -- Chuẩn bị prompt & part
                local part = nearestBerry.PrimaryPart or nearestBerry:FindFirstChildWhichIsA("BasePart")
                if not nearestBerry.PrimaryPart then
                    nearestBerry.PrimaryPart = part
                end

                local prompt = nearestBerry:FindFirstChildWhichIsA("ProximityPrompt", true)
                            or nearestBerry:FindFirstChildWhichIsA("ClickDetector", true)
                            or nearestBerry:FindFirstChild("TouchInterest", true)

                if not (prompt and part) then
                    task.wait(0.2)
                    continue
                end

                -- Teleport và freeze
                local targetCF = part.CFrame + Vector3.new(0, 2, 0)
                TweenService:Create(hrp, TweenInfo.new(0.2), {CFrame = targetCF}):Play():Wait()

                hum:ChangeState(Enum.HumanoidStateType.Physics)
                hrp.Anchored = true

                -- Click prompt liên tục cho tới khi berry biến mất
                while collecting and nearestBerry.Parent do
                    pcall(function()
                        if prompt:IsA("ProximityPrompt") then
                            fireproximityprompt(prompt)
                        elseif prompt:IsA("ClickDetector") then
                            fireclickdetector(prompt)
                        elseif prompt.Name == "TouchInterest" then
                            firetouchinterest(hrp, part, 0)
                            task.wait()
                            firetouchinterest(hrp, part, 1)
                        end
                    end)
                    task.wait(0.05)
                end

                -- Unfreeze để di chuyển sang berry khác
                hrp.Anchored = false
                hum:ChangeState(Enum.HumanoidStateType.GettingUp)

                task.wait(0.2) -- nghỉ nhẹ rồi lặp lại
            end
        end)
    end
})

local TeleportTab = Window:CreateTab("Teleport", "map")

TeleportTab:CreateSection("Main Location")

local locations = {
    Home = Vector3.new(60.99, 48.58, 417.10),
    Balcony = Vector3.new(37.34, 52.72, 420.62),
    River = Vector3.new(-227.99, -0.84, 341.59),
    Skeleton = Vector3.new(145.43, 12.63, 234.22)
}

for name, position in pairs(locations) do
    TeleportTab:CreateButton({
        Name = "Go to " .. name,
        Callback = function()
            local hrp = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if hrp then
                hrp.CFrame = CFrame.new(position)
            end
        end
    })
end

local KTab = Window:CreateTab("Misc", "package")
  
KTab:CreateButton({
    Name = "Collect Aura",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/Xd/refs/heads/main/CollectAura"))()
    end,
})
  
  KTab:CreateButton({
    Name = "Inf Yield Edit",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/idtkby/Xd/refs/heads/main/infedit"))()
    end,
  })
  
end)
